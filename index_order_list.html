<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>订单列表</title>
		<script src="js/mui.js"></script>
		<script src="js/vue.js"></script>
		<script src="js/vue-tap.js"></script>
		<script src="js/api.js"></script>
		<link href="css/mui.min.css" rel="stylesheet" />
		<link href="css/common.css" rel="stylesheet" />
		<style type="text/css">

		</style>
	</head>

	<!--下拉刷新容器-->
	<div id="refreshContainer" class="mui-content mui-scroll-wrapper">
		<div class="mui-scroll">
			<!--数据列表-->
			<ul id="order-list" class="mui-table-view mui-table-view-chevron" style="background-color: inherit;">
				<li style="margin-top: 10px;background-color: white;" v-for="order in orderList[orderType]" track-by="$index" class="mui-table-view-cell">
					<a v-tap="showDetail(order)" style="overflow: hidden;">
						<p style="font-weight: bold;color: #333333">流水号：{{order.orderId}}<span style="float: right;margin-left: 20px;">{{order.status}}</span></p>
						<p style="font-weight: 500;">下单日期：{{order.time}}</p>
						<p class="list-col-2">
							<span>机具编号：{{order.machineId}}</span>
							<span>机具型号：{{order.machineType}}</span>
						</p>
						<p class="list-col-2">
							<span>装机地址：{{order.machineAddr}}</span>
							<span>序列号：{{order.machineSn}}</span>
						</p>
					</a>
				</li>
			</ul>
		</div>
	</div>
	<script src="js/common.js"></script>
	<script type="text/javascript">
		var vm = new Vue({
			el: '#refreshContainer',
			methods: {
				showDetail:function(order){
					if(order.status == '已出发') {
						redirect('pages/order_detail_out.html');
					} else if(order.status == '维修中') {
						redirect('pages/order_detail_repair.html');
					}
				},
			},
			data: {
				title: '派单',
				orderType:1,
				orderList: {
					"1":[{
						status:'维修中',
						orderId:'132',
						machineSn:'123eqw',
						machineAddr: 1,
						machineOrder: 1,
						machineType: 1,
						machineId: 1,
						time:"2017-02-03 20:22:22"
					},{
						status:'已出发',
						orderId:'132',
						machineSn:'123eqw',
						machineAddr: 1,
						machineOrder: 1,
						machineType: 1,
						machineId: 1,
						time:"2017-02-03 20:22:22"
					},
					]
				},
			},

		})

		mui.init({
			pullRefresh: {
				container: "#refreshContainer", //下拉刷新容器标识，querySelector能定位的css选择器均可，比如：id、.class等
				down: {
					height: 50, //可选,默认50.触发下拉刷新拖动距离,
					auto: true, //可选,默认false.自动下拉刷新一次
					contentdown: "下拉可以刷新", //可选，在下拉可刷新状态时，下拉刷新控件上显示的标题内容
					contentover: "释放立即刷新", //可选，在释放可刷新状态时，下拉刷新控件上显示的标题内容
					contentrefresh: "正在刷新...", //可选，正在刷新状态时，下拉刷新控件上显示的标题内容
					callback: function() {
						mui('#refreshContainer').pullRefresh().endPulldownToRefresh();
					} //必选，刷新函数，根据具体业务来编写，比如通过ajax从服务器获取新数据；
				}
			}
		})
		window.addEventListener("change_type", function(e) {
			console.log(JSON.stringify(e.detail.type));
			vm.orderType = e.detail.type;
			bank.get(ORDER_LIST_API,function(e){
				vm.orderList = e.list
			})
		});
	</script>

</html>